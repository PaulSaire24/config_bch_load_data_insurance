       -- dbms_output.put_line(LPAD(entity||branch_id||'00'||account,20,'0')||'|'||LPAD(i*11,10,'0')||'|00001|2101|02'||'|    168'||LPAD(i,3,'0')||'|'||LPAD(premium,15,'0')||'|USD|'||'2020-02-15|2020-02-14|2020-03-16|CP|000000000011139|000000000000000');

--select  LPAD( REPLACE(to_char(dbms_random.value(1,1000)),','), 5,'0') num from dual;
SET LINESIZE 3500;
SET PAGESIZE 5000;


SELECT  
    (A.INSURANCE_CONTRACT_ENTITY_ID || 
    A.INSURANCE_CONTRACT_BRANCH_ID ||
    B.CONTRACT_FIRST_VERFN_DIGIT_ID ||
    B.CONTRACT_SECOND_VERFN_DIGIT_ID ||
    A.INSRC_CONTRACT_INT_ACCOUNT_ID) || '|'|| 
    LPAD( case when B.POLICY_ID is null then REPLACE(to_char(dbms_random.value(990002000,990020000)),',') else B.POLICY_ID end,10,'0') ||'|'|| 
    LPAD( REPLACE(to_char(dbms_random.value(3000,3999)),',',''), 5,'0') ||'|'|| 
    LPAD( REPLACE(to_char(dbms_random.value(500,599)),',',''), 4,'0') ||'|'|| 
    LPAD( A.POLICY_RECEIPT_ID +1 ,2,'0') ||'|'|| 
    LPAD( nvl(A.INSURANCE_COMPANY_RECEIPT_ID, LPAD( REPLACE(to_char(dbms_random.value(10000009945,10099299945)),',',''),10,'0') ),20,'0') ||'|'|| 
    LPAD( REPLACE(to_char(A.PREMIUM_PAYMENT_RECEIPT_AMOUNT), ',') ,15,'0') ||'|'|| 
    LPAD( A.CURRENCY_ID,3,'0') ||'|'|| 
    -- ADD_MONTHS(to_Date(my_date,'DD/MM/YYYY'),j-1)
    LPAD( to_char(ADD_MONTHS(A.RECEIPT_EXPIRATION_DATE,1), 'YYYY-MM-DD') ,10,'0') ||'|'||  
    LPAD( to_char(ADD_MONTHS(A.RECEIPT_EXPIRATION_DATE,1), 'YYYY-MM-DD') ,10,'0') ||'|'|| 
    LPAD( to_char(ADD_MONTHS(A.RECEIPT_EXPIRATION_DATE, 2), 'YYYY-MM-DD') ,10,'0') ||'|'|| 
    LPAD( '01',2,'0') ||'|'|| 
    LPAD( '0',15,'0') ||'|'|| 
    LPAD( '0',15,'0') ||'|'|| 
    LPAD( nvl(A.RENEWAL_NUMBER,0),3,'0') ||'|'|| 
    RPAD( 'VIDA',4,' ') archivo_Cobranza,
    
    B.PAYMENT_FREQUENCY_ID,
    to_char(A.RECEIPT_COLLECTION_DATE, 'YYYY-MM-DD') RECEIPT_COLLECTION_DATE,
    B.CREATION_DATE,
    B.INSURANCE_PRODUCT_ID,
    B.INSURANCE_MODALITY_TYPE,
    B.PREMIUM_AMOUNT,
    A.PREMIUM_PAYMENT_RECEIPT_AMOUNT

FROM PISD.T_PISD_INSURANCE_CONTRACT B 
INNER JOIN PISD.T_PISD_INSURANCE_CTR_RECEIPTS A ON A.INSURANCE_CONTRACT_ENTITY_ID = B.INSURANCE_CONTRACT_ENTITY_ID
                                            AND A.INSURANCE_CONTRACT_BRANCH_ID = B.INSURANCE_CONTRACT_BRANCH_ID
                                            AND A.INSRC_CONTRACT_INT_ACCOUNT_ID = B.INSRC_CONTRACT_INT_ACCOUNT_ID
INNER JOIN PISD.T_PISD_INSRNC_PRD_MODALITY C ON  C.INSURANCE_PRODUCT_ID = B.INSURANCE_PRODUCT_ID AND C.INSURANCE_MODALITY_TYPE=B.INSURANCE_MODALITY_TYPE
INNER JOIN PISD.T_PISD_INSURANCE_PRODUCT D ON D.INSURANCE_PRODUCT_ID = B.INSURANCE_PRODUCT_ID
WHERE 
   B.CONTRACT_STATUS_ID = 'FOR'
   and B.insurance_product_id=21
   and  (A.INSURANCE_CONTRACT_ENTITY_ID || 
    A.INSURANCE_CONTRACT_BRANCH_ID ||
    B.CONTRACT_FIRST_VERFN_DIGIT_ID ||
    B.CONTRACT_SECOND_VERFN_DIGIT_ID ||
    A.INSRC_CONTRACT_INT_ACCOUNT_ID) in (
   
   '00110284794000016943',
'00110115374000219135',
'00110115344000219151',
'00110115304000219186',
'00110115324000219208',
'00110284744000017087',
'00110284724000017125',
'00110284744000017214',
'00110284704000017230'
)

ORDER BY     INSURANCE_CONTRACT_END_DATE DESC





